"""
================================================================================
YuanJing AI æ•°æ®æ ‡å‡†ç”Ÿæˆè„šæœ¬ v2
ç”¨äºç”Ÿæˆ AIGC ä¸ä¼ ç»Ÿç¯¡æ”¹å…¼å®¹æ€§éªŒè¯æ•°æ®è¡¨
è¾“å‡ºæ–‡ä»¶: Yuanjing_Data_Standard_v2.xlsx
================================================================================

ã€è¡¨ç»“æ„æ¦‚è§ˆã€‘
è¿™å¼ è¡¨æ˜¯æ•´ä¸ªé¡¹ç›®çš„"æ•°æ®åœ°åŸº"ï¼Œåˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š
  - åŸºç¡€ä¿¡æ¯åŒºï¼šå–‚ç»™ç³»ç»Ÿçš„åŸææ–™
  - é€šé“æ ‡ç­¾åŒºï¼šç»™æ¨¡å‹è®­ç»ƒ/æµ‹è¯•ç”¨çš„"æ ‡å‡†ç­”æ¡ˆ"
  - å…ƒæ•°æ®åŒºï¼šç»™é€»è¾‘æ¨ç†/åŒºå—é“¾ç”¨çš„ç»“æ„åŒ–æ•°æ®

================================================================================
ã€å­—æ®µè¯¦ç»†è§£é‡Š (11åˆ—: A-K)ã€‘
================================================================================

â–¶ ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€è¾“å…¥åŒº (Basic Input) - A~Cåˆ—
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”‚ Aåˆ—: ID (æ•°æ®ç¼–å·)
  â”‚   - ç¤ºä¾‹: "001", "002"...
  â”‚   - ä½œç”¨: å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¸Šé“¾æ—¶ä½œä¸ºç´¢å¼•é”®(Key)
  â”‚
  â”‚ Båˆ—: Image_Path (å›¾ç‰‡ç›¸å¯¹è·¯å¾„)
  â”‚   - ç¤ºä¾‹: "./data/images/001_fake.jpg"
  â”‚   - ä½œç”¨: Pythonè„šæœ¬é€šè¿‡æ­¤è·¯å¾„è¯»å–å›¾ç‰‡ï¼Œæ–‡ä»¶åå»ºè®®ç”¨è‹±æ–‡
  â”‚
  â”‚ Cåˆ—: Text_Content (æ–‡æœ¬å†…å®¹)
  â”‚   - ç¤ºä¾‹: "çªå‘æ–°é—»ï¼šæ˜¨æ™šå·´é»åœ£æ¯é™¢å†æ¬¡å‘ç”Ÿç«ç¾ã€‚"
  â”‚   - ä½œç”¨: è¾“å…¥ç»™é€šé“2(CLIP)å’Œé€šé“3(é€»è¾‘)çš„æ–‡æœ¬ç´ æ
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¶ ç¬¬äºŒéƒ¨åˆ†ï¼šé€šé“æ ‡ç­¾åŒº (Channel Ground Truth) - D~Gåˆ—
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”‚ Dåˆ—: GT_Final_Label (æœ€ç»ˆçœŸå‡æ ‡ç­¾)
  â”‚   - å–å€¼: "Fake"(å‡) / "Real"(çœŸ)
  â”‚   - ä½œç”¨: å…¨å±€åˆ¤æ–­ï¼Œä»»ä¸€é€šé“æœ‰é—®é¢˜å³ä¸ºFake
  â”‚
  â”‚ Eåˆ—: Ch1_Tamper_Label (é€šé“1ï¼šæ˜¯å¦ç¯¡æ”¹)
  â”‚   - å–å€¼: 1(å›¾è¢«Pè¿‡) / 0(åŸå›¾)
  â”‚   - ç»™è°çœ‹: ç‹å—£è± - ç¯¡æ”¹æ£€æµ‹æ¨¡å‹
  â”‚   - ä½œç”¨: æµ‹è¯•ç¯¡æ”¹æ£€æµ‹æ¨¡å‹ï¼Œæ¨¡å‹è¾“å‡ºåº”ä¸æ­¤æ ‡ç­¾ä¸€è‡´
  â”‚
  â”‚ Fåˆ—: Tamper_Type (ç¯¡æ”¹ç±»å‹) ã€æ–°å¢å­—æ®µã€‘
  â”‚   - å–å€¼: "PS"(ä¼ ç»ŸPSç¯¡æ”¹) / "AIGC"(AIæ¶ˆé™¤/é‡ç»˜) / "None"(çœŸå›¾)
  â”‚   - ä½œç”¨: åŒºåˆ†ä¼ ç»Ÿç¯¡æ”¹ä¸AIç¯¡æ”¹ï¼Œä¾¿äºç»Ÿè®¡æ¨¡å‹å¯¹ä¸¤ç±»çš„æ£€æµ‹æˆåŠŸç‡
  â”‚   - PSç¯¡æ”¹: Photoshopæ‹¼æ¥ã€å¤åˆ¶ç§»åŠ¨ã€å…‹éš†ç­‰
  â”‚   - AIGCç¯¡æ”¹: æ‰‹æœºæ¶ˆé™¤ç¬”ã€ç¾å›¾ç§€ç§€AIæ¶ˆé™¤ã€Magic Eraserç­‰
  â”‚
  â”‚ Gåˆ—: Ch2_Consis_Label (é€šé“2ï¼šå›¾æ–‡ä¸€è‡´æ€§)
  â”‚   - å–å€¼: 1(ä¸€è‡´/åŒ¹é…) / 0(ä¸ä¸€è‡´/ä¸åŒ¹é…)
  â”‚   - ç»™è°çœ‹: é˜Ÿå‹B - CLIPæ¨¡å‹
  â”‚   - ä½œç”¨: æµ‹è¯•CLIPæ¨¡å‹èƒ½å¦è¯†åˆ«å›¾æ–‡åå·®(å¦‚å›¾æ˜¯æ™´å¤©ï¼Œæ–‡æ˜¯ä¸‹é›¨)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¶ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå…ƒæ•°æ®åŒº (Metadata for Logic & Blockchain) - H~Kåˆ—
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â”‚ Håˆ—: Meta_Time (æ—¶é—´å…ƒæ•°æ®)
  â”‚   - ç¤ºä¾‹: "Night", "Day", "2024"
  â”‚   - ä½œç”¨: é€»è¾‘åˆ¤æ–­ç”¨ï¼Œä¸æ–‡æœ¬æå–çš„æ—¶é—´å¯¹æ¯”æ£€æµ‹çŸ›ç›¾
  â”‚
  â”‚ Iåˆ—: Meta_Scene (åœºæ™¯å…ƒæ•°æ®)
  â”‚   - ç¤ºä¾‹: "Fire", "Street", "Indoor", "Forest"
  â”‚   - ä½œç”¨: é€»è¾‘åˆ¤æ–­ç”¨ï¼Œæ£€æµ‹åœºæ™¯æè¿°æ˜¯å¦ä¸å›¾ç‰‡ä¸€è‡´
  â”‚
  â”‚ Jåˆ—: Meta_Object (å…³é”®ç‰©ä½“)
  â”‚   - ç¤ºä¾‹: "Car", "Person", "Smoke", "Tree/Fire"
  â”‚   - ä½œç”¨: è¾…åŠ©åˆ¤æ–­å›¾ç‰‡ä¸­ä¸»ä½“æ˜¯å¦å­˜åœ¨
  â”‚
  â”‚ Kåˆ—: Source_Note (å¤‡æ³¨/é€ å‡æ‰‹æ®µ)
  â”‚   - ç¤ºä¾‹: "ä½¿ç”¨PSæ“¦é™¤äº†è·¯äºº", "æ–‡æ¡ˆä¸ºChatGPTç”Ÿæˆ"
  â”‚   - ä½œç”¨: é¡¹ç›®æ–‡æ¡£ï¼Œè®°å½•æ•°æ®æ„é€ æ–¹æ³•ï¼Œç­”è¾©æ—¶å¯å¼•ç”¨
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================
ã€ä»»åŠ¡åˆ†é…æŒ‡å—ã€‘
================================================================================
1. å¯¹ç¯¡æ”¹æ£€æµ‹ï¼š
   â†’ æ¨¡å‹è¯»å– Båˆ—(Image_Path)ï¼Œè¾“å‡ºä¸ Eåˆ—(Ch1_Tamper_Label) å¯¹æ¯”
   â†’ Eåˆ—=1æ—¶ï¼Œæ¨¡å‹åº”è¾“å‡ºMaskæˆ–é«˜æ¦‚ç‡

2. å¯¹å›¾æ–‡ä¸€è‡´æ€§æ£€æµ‹ï¼š
   â†’ æ¨¡å‹è¯»å– Båˆ— + Cåˆ—(Text)ï¼Œè¾“å‡ºä¸ Gåˆ—(Ch2_Consis_Label) å¯¹æ¯”
   â†’ Gåˆ—=0æ—¶ï¼Œç›¸ä¼¼åº¦åˆ†æ•°åº”è¯¥å¾ˆä½

3. å¯¹é€»è¾‘æ¨ç†æ¨¡å—ï¼š
   â†’ æå–æ–‡æœ¬å…³é”®è¯ï¼Œä¸ Hã€Iåˆ—(Meta) è¿›è¡Œæ¯”å¯¹æ£€æµ‹çŸ›ç›¾

================================================================================
ã€æ•°æ®æ„é€ æ–¹æ³• (SOP)ã€‘
================================================================================
Type A: ä¼ ç»ŸPSç¯¡æ”¹æ ·æœ¬
  - å·¥å…·: Photoshop
  - æ“ä½œ: å°†ç‰©ä½“(å¦‚è½¦ã€äºº)æŠ å‡ºç²˜è´´åˆ°å¦ä¸€èƒŒæ™¯ï¼›æˆ–å¤åˆ¶äº‘æœµ/è‰åœ°è¦†ç›–å¦ä¸€åŒºåŸŸ
  - è¦æ±‚: è¾¹ç¼˜å°½é‡è‚‰çœ¼éš¾ä»¥å¯Ÿè§‰ï¼Œæµ‹è¯•æ¨¡å‹å¯¹å¾®è§‚è¾¹ç¼˜çš„æ•æ„Ÿåº¦

Type B: AIæ¶ˆé™¤/é‡ç»˜æ ·æœ¬
  - å·¥å…·: æ‰‹æœºç›¸å†Œ"æ¶ˆé™¤ç¬”"ã€ç¾å›¾ç§€ç§€AIæ¶ˆé™¤ã€ç½‘é¡µç‰ˆMagic Eraser
  - æ“ä½œ: ç§»é™¤å›¾åƒä¸­çš„æ˜¾è‘—ç‰©ä½“(å¦‚åƒåœ¾æ¡¶ã€ç”µçº¿æ†)
  - è¦æ±‚: ä¸è¦ä½¿ç”¨å…¨å›¾ç”Ÿæˆçš„å›¾ç‰‡ï¼Œåªé’ˆå¯¹çœŸå®ç…§ç‰‡è¿›è¡Œå±€éƒ¨ä¿®æ”¹
================================================================================
"""

import pandas as pd
import os

# ============================================================================
# 1. å­—æ®µå®šä¹‰ (11åˆ—: A-K)
# ============================================================================
columns_order = [
    "ID",               # Aåˆ—: æ•°æ®ç¼–å·ï¼Œå”¯ä¸€æ ‡è¯†ç¬¦
    "Image_Path",       # Båˆ—: å›¾ç‰‡ç›¸å¯¹è·¯å¾„ï¼ŒPythonè„šæœ¬è¯»å–ç”¨
    "Text_Content",     # Cåˆ—: æ–‡æœ¬å†…å®¹ï¼Œè¾“å…¥ç»™CLIPå’Œé€»è¾‘é€šé“
    "GT_Final_Label",   # Dåˆ—: æœ€ç»ˆçœŸå‡æ ‡ç­¾ (Fake/Real)
    "Ch1_Tamper_Label", # Eåˆ—: é€šé“1-æ˜¯å¦ç¯¡æ”¹ (1=ç¯¡æ”¹/0=åŸå›¾)
    "Tamper_Type",      # Fåˆ—: ç¯¡æ”¹ç±»å‹ (PS/AIGC/None)
    "Ch2_Consis_Label", # Gåˆ—: é€šé“2-å›¾æ–‡ä¸€è‡´æ€§ (1=ä¸€è‡´/0=ä¸ä¸€è‡´)
    "Meta_Time",        # Håˆ—: æ—¶é—´å…ƒæ•°æ® (Day/Nightç­‰)
    "Meta_Scene",       # Iåˆ—: åœºæ™¯å…ƒæ•°æ® (Fire/Streetç­‰)
    "Meta_Object",      # Jåˆ—: å…³é”®ç‰©ä½“ (Car/Personç­‰)
    "Source_Note"       # Kåˆ—: å¤‡æ³¨/é€ å‡æ‰‹æ®µè¯´æ˜
]

# ============================================================================
# 2. æ„é€ ç¤ºä¾‹æ•°æ®
# ============================================================================
# åŒ…å«ä¸‰ç§å…¸å‹é€ å‡æƒ…å†µï¼šå›¾ç‰‡ç¯¡æ”¹(PS/AIGC)ã€å›¾æ–‡ä¸ç¬¦(ç§»èŠ±æ¥æœ¨)ã€é€»è¾‘å†²çª(è¿åå¸¸è¯†)
data = [
    # ==================== Type A: ä¼ ç»ŸPSç¯¡æ”¹æ ·æœ¬ ====================
    # åœºæ™¯ï¼šç”¨PSæŠŠä¸¤ä¸ªäººPåœ¨äº†ä¸€èµ·
    {
        "ID": "001",
        "Image_Path": "./data/images/ps_splicing_001.jpg",
        "Text_Content": "ä¸¤å›½é¢†å¯¼äººåœ¨å³°ä¼šä¸Šäº²åˆ‡æ¡æ‰‹ã€‚",  # æ–‡å­—çœ‹ç€æ²¡æ¯›ç—…
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 1,  # é‡ç‚¹ï¼šå›¾æ˜¯å‡çš„ï¼Œè¢«Pè¿‡
        "Tamper_Type": "PS",    # ä¼ ç»ŸPSæ‹¼æ¥ç¯¡æ”¹
        "Ch2_Consis_Label": 1,  # å›¾æ–‡çœ‹èµ·æ¥æ˜¯é…çš„(å› ä¸ºå›¾På¾—å¥½)
        "Meta_Time": "Day",
        "Meta_Scene": "Meeting",
        "Meta_Object": "Person",
        "Source_Note": "PSæ‹¼æ¥ï¼šäººç‰©æŠ å›¾ç²˜è´´åˆ°ä¼šè®®èƒŒæ™¯"
    },
    # åœºæ™¯ï¼šå¤åˆ¶å›¾ä¸­ç‰©ä½“è¦†ç›–å¦ä¸€åŒºåŸŸ
    {
        "ID": "002",
        "Image_Path": "./data/images/ps_copymove_001.jpg",
        "Text_Content": "è‰åŸä¸Šæˆç¾¤çš„ç¾Šæ­£åœ¨åƒè‰ã€‚",
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 1,
        "Tamper_Type": "PS",    # ä¼ ç»ŸPSå¤åˆ¶ç§»åŠ¨
        "Ch2_Consis_Label": 1,
        "Meta_Time": "Day",
        "Meta_Scene": "Grassland",
        "Meta_Object": "Animal/Grass",
        "Source_Note": "PSå¤åˆ¶ç§»åŠ¨ï¼šå¤åˆ¶ç¾Šç¾¤å¢åŠ æ•°é‡"
    },
    
    # ==================== Type B: AIæ¶ˆé™¤/é‡ç»˜ç¯¡æ”¹æ ·æœ¬ ====================
    # åœºæ™¯ï¼šä½¿ç”¨æ‰‹æœºæ¶ˆé™¤ç¬”ç§»é™¤ç‰©ä½“
    {
        "ID": "003",
        "Image_Path": "./data/images/aigc_eraser_001.jpg",
        "Text_Content": "å¹²å‡€æ•´æ´çš„åŸå¸‚è¡—é“ã€‚",
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 1,  # å›¾æ˜¯å‡çš„ï¼ˆç»è¿‡AIä¿®æ”¹ï¼‰
        "Tamper_Type": "AIGC",  # AIæ¶ˆé™¤ç¯¡æ”¹
        "Ch2_Consis_Label": 1,
        "Meta_Time": "Day",
        "Meta_Scene": "Street",
        "Meta_Object": "Building/Road",
        "Source_Note": "AIæ¶ˆé™¤ï¼šä½¿ç”¨æ‰‹æœºæ¶ˆé™¤ç¬”ç§»é™¤è·¯è¾¹åƒåœ¾æ¡¶"
    },
    # åœºæ™¯ï¼šä½¿ç”¨ç¾å›¾ç§€ç§€AIæ¶ˆé™¤ç”µçº¿æ†
    {
        "ID": "004",
        "Image_Path": "./data/images/aigc_inpaint_001.jpg",
        "Text_Content": "è“å¤©ä¸‹çš„ç¾ä¸½é£æ™¯ã€‚",
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 1,
        "Tamper_Type": "AIGC",  # AIé‡ç»˜ç¯¡æ”¹
        "Ch2_Consis_Label": 1,
        "Meta_Time": "Day",
        "Meta_Scene": "Outdoor",
        "Meta_Object": "Sky/Tree",
        "Source_Note": "AIé‡ç»˜ï¼šä½¿ç”¨ç¾å›¾ç§€ç§€æ¶ˆé™¤ç”µçº¿æ†"
    },
    
    # ==================== å›¾æ–‡ä¸ç¬¦æ ·æœ¬ (ç§»èŠ±æ¥æœ¨) ====================
    # åœºæ™¯ï¼šå›¾æ˜¯çœŸå®çš„æ£®æ—å¤§ç«ï¼Œæ–‡å­—è¯´æ˜¯"æ˜¨æ™šå¸‚ä¸­å¿ƒç«ç¾"
    {
        "ID": "005",
        "Image_Path": "./data/images/real_forest_fire.jpg",
        "Text_Content": "çªå‘ï¼šæ˜¨æ™šå¸‚ä¸­å¿ƒå•†åœºå‘ç”Ÿç‰¹å¤§ç«ç¾ã€‚",
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 0,  # å›¾æ˜¯çœŸçš„ï¼Œæ²¡Pè¿‡
        "Tamper_Type": "None",  # çœŸå›¾
        "Ch2_Consis_Label": 0,  # é‡ç‚¹ï¼šå›¾æ˜¯æ£®æ—ï¼Œæ–‡æ˜¯å•†åœºï¼Œä¸é…
        "Meta_Time": "Day",     # å›¾é‡Œçœ‹èµ·æ¥æ˜¯ç™½å¤©
        "Meta_Scene": "Forest",
        "Meta_Object": "Tree/Fire",
        "Source_Note": "çœŸå®æ£®æ—ç«ç¾å›¾é…è°£è¨€æ–‡å­—ï¼ˆç§»èŠ±æ¥æœ¨ï¼‰"
    },
    
    # ==================== é€»è¾‘å†²çªæ ·æœ¬ (è¿åå¸¸è¯†) ====================
    # åœºæ™¯ï¼šå›¾æ˜¯æ™´ç©ºä¸‡é‡Œï¼Œæ–‡å­—éè¦è¯´æ˜¯"å°é£ç™»é™†ç°åœº"
    {
        "ID": "006",
        "Image_Path": "./data/images/real_sunny_sky.jpg",
        "Text_Content": "å°é£'æ¢…èŠ±'åˆšåˆšç™»é™†ï¼Œç‹‚é£æš´é›¨ã€‚",
        "GT_Final_Label": "Fake",
        "Ch1_Tamper_Label": 0,  # å›¾æ˜¯çœŸçš„
        "Tamper_Type": "None",  # çœŸå›¾
        "Ch2_Consis_Label": 0,  # CLIPä¹Ÿèƒ½æµ‹å‡ºæ¥ä¸åŒ¹é…
        "Meta_Time": "Day",
        "Meta_Scene": "Sunny Sky",
        "Meta_Object": "Sky/Cloud",
        "Source_Note": "å¤©æ°”å±æ€§é€»è¾‘å†²çªï¼šæ™´å¤©å›¾é…å°é£æ–‡å­—"
    }
]

# ============================================================================
# 3. åˆ›å»º DataFrame å¹¶å¯¼å‡º
# ============================================================================
df = pd.DataFrame(data)

# å¼ºåˆ¶è°ƒæ•´åˆ—é¡ºåºä»¥ç¬¦åˆ Excel è¡¨å¤´è¦æ±‚
df = df[columns_order]

# å¯¼å‡ºä¸º Excel æ–‡ä»¶
file_name = "Yuanjing_Data_Standard_v2.xlsx"

try:
    # æ£€æŸ¥æ˜¯å¦å®‰è£…äº† openpyxlï¼Œå¦‚æœæ²¡æœ‰è¯·è¿è¡Œ pip install openpyxl
    df.to_excel(file_name, index=False, engine='openpyxl')
    
    # è·å–ç»å¯¹è·¯å¾„ï¼Œæ–¹ä¾¿æŸ¥æ‰¾
    file_path = os.path.abspath(file_name)
    
    print("=" * 60)
    print("âœ… Excel æ–‡ä»¶åˆ›å»ºæˆåŠŸ!")
    print("=" * 60)
    print(f"ğŸ“ æ–‡ä»¶è·¯å¾„: {file_path}")
    print("-" * 60)
    
    print("\nğŸ“‹ è¡¨å¤´å­—æ®µ (11åˆ— A-K):")
    print("-" * 60)
    for i, col in enumerate(df.columns):
        print(f"  {chr(65+i)}åˆ—: {col}")
    
    print("\nğŸ“Š æ•°æ®ç»Ÿè®¡:")
    print("-" * 60)
    print(f"  æ€»æ ·æœ¬æ•°: {len(df)}")
    print(f"  â”œâ”€ PSç¯¡æ”¹æ ·æœ¬ (ä¼ ç»Ÿç¯¡æ”¹): {len(df[df['Tamper_Type'] == 'PS'])} æ¡")
    print(f"  â”œâ”€ AIGCç¯¡æ”¹æ ·æœ¬ (AIç¯¡æ”¹): {len(df[df['Tamper_Type'] == 'AIGC'])} æ¡")
    print(f"  â””â”€ çœŸå›¾æ ·æœ¬ (æœªç¯¡æ”¹): {len(df[df['Tamper_Type'] == 'None'])} æ¡")
    
    print("\nğŸ” æ•°æ®é¢„è§ˆ:")
    print("-" * 60)
    preview_cols = ['ID', 'Tamper_Type', 'Ch1_Tamper_Label', 'Ch2_Consis_Label', 'Source_Note']
    print(df[preview_cols].to_string(index=False))
    
    print("\n" + "=" * 60)
    print("ğŸ’¡ ä½¿ç”¨æç¤º:")
    print("  - ç‹å—£è±: è¯»å–Båˆ—(Image_Path), å¯¹æ¯”Eåˆ—(Ch1_Tamper_Label)")
    print("  - CLIPé˜Ÿå‹: è¯»å–B+Cåˆ—, å¯¹æ¯”Gåˆ—(Ch2_Consis_Label)")
    print("  - é€»è¾‘æ¨ç†: æå–æ–‡æœ¬å…³é”®è¯, å¯¹æ¯”Hã€Iåˆ—(Meta)")
    print("=" * 60)
    
except ImportError:
    print("âŒ Error: 'openpyxl' æ¨¡å—æœªå®‰è£…")
    print("   è¯·è¿è¡Œ: pip install openpyxl")
except Exception as e:
    print(f"âŒ Error occurred: {e}")
